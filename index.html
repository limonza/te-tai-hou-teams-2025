<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Te Tai Hou Teams – 2025</title>
<style>
body {
  font-family: "Segoe UI", Roboto, sans-serif;
  background-color: #f9fafb;
  margin: 0;
  padding: 20px;
  color: #333;
}

/* Header */
header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
}
header img {
  height: 50px;
  border-radius: 50%;
}
header h1 {
  font-size: 1.8em;
  margin: 0;
  color: #1a365d;
}

/* Controls */
.controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin-bottom: 16px;
}
select {
  padding: 6px 10px;
  border: 1px solid #cbd5e0;
  border-radius: 6px;
  font-size: 0.9em;
}
select:focus {
  outline: none;
  border-color: #2b6cb0;
  box-shadow: 0 0 4px rgba(43,108,176,0.3);
}

/* Table */
table {
  width: 50%;
  max-width: 800px;
  border-collapse: collapse;
  background-color: #fff;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  margin: 0 auto;
}
thead th {
  background-color: #2b6cb0;
  color: #fff;
  text-align: left;
  padding: 10px;
  font-weight: 600;
  border-bottom: 2px solid #1a365d;
}
tbody td {
  padding: 10px;
  border-bottom: 1px solid #e2e8f0;
}

/* Group headers */
.group-header {
  background-color: #e6fffa;
  color: #234e52;
  font-weight: bold;
  padding: 8px;
  cursor: pointer;
  border-top: 2px solid #81e6d9;
  text-align: center;
}
.group-header:hover {
  background-color: #b2f5ea;
}
.group-content.hidden {
  display: none;
}

/* Responsive */
@media (max-width: 768px) {
  table, thead, tbody, th, td, tr {
    display: block;
  }
  thead {
    display: none;
  }
  tr {
    margin-bottom: 12px;
    border-bottom: 1px solid #ddd;
  }
  td {
    display: flex;
    justify-content: space-between;
    padding: 8px;
  }
  td::before {
    content: attr(data-label);
    font-weight: 600;
    color: #2b6cb0;
  }
}
</style>
</head>
<body>
<header>
  <a href="https://www.poriruaheatbasketballclub.org" target="_blank">
    <img src="images/logo.png" alt="Club Logo">
  </a>
  <h1>Te Tai Hou Teams – 2025</h1>
</header>

<div class="controls">
  <label for="indicativeFilter">Filter by Indicative Selection:</label>
  <select id="indicativeFilter">
    <option value="">All</option>
  </select>
</div>

<div id="tableContainer"></div>

<script>
const groupOrder = [
  "10U Dev", "10U Elite", "12U Dev", "12U Elite",
  "14U Dev Blue", "14U Elite Black", "14U Elite Gold", "14U Dev Red",
  "16U Dev", "16U Elite", "20U", "Mens", "Womens"
];

// Load data.csv or fallback to demo data
async function loadData() {
  let text;
  try {
    const response = await fetch('data.csv');
    if (!response.ok) throw new Error('Fetch failed');
    text = await response.text();
  } catch {
    console.warn("⚠️ Using fallback demo data because data.csv couldn't be loaded.");
    text = `First Name,Last Name,Indicative Selection
John,Smith,10U Dev
Mary,Jones,10U Dev
Bob,Brown,12U Elite
Kate,Wilson,14U Elite Black
Tim,Ngatai,
Sarah,Taylor,Womens`;
  }

  const rows = text.trim().split('\n').map(r => r.split(','));
  const headers = rows[0].map(h => h.trim());
  const data = rows.slice(1)
    .map(r => Object.fromEntries(r.map((v, i) => [headers[i], v.trim()])))
    .filter(row => row["Indicative Selection"]);

  const grouped = groupData(data, "Indicative Selection");
  renderFilterOptions(grouped);
  renderTable(grouped);
}

function groupData(data, key) {
  const groups = {};
  data.forEach(row => {
    const groupKey = row[key];
    if (!groups[groupKey]) groups[groupKey] = [];
    groups[groupKey].push(row);
  });
  return groups;
}

function renderFilterOptions(grouped) {
  const filter = document.getElementById("indicativeFilter");
  Object.keys(grouped)
    .sort((a, b) => groupOrder.indexOf(a) - groupOrder.indexOf(b))
    .forEach(key => {
      const opt = document.createElement("option");
      opt.value = key;
      opt.textContent = key;
      filter.appendChild(opt);
    });

  filter.addEventListener("change", () => {
    const selected = filter.value;
    document.querySelectorAll(".group-wrapper").forEach(el => {
      el.style.display = !selected || el.dataset.group === selected ? "" : "none";
    });
  });
}

function renderTable(groups) {
  const container = document.getElementById("tableContainer");
  container.innerHTML = "";

  groupOrder.forEach(group => {
    if (!groups[group]) return;

    const wrapper = document.createElement("div");
    wrapper.className = "group-wrapper";
    wrapper.dataset.group = group;

    const header = document.createElement("div");
    header.className = "group-header";
    header.textContent = group;
    header.onclick = () => content.classList.toggle("hidden");

    const content = document.createElement("div");
    content.className = "group-content";

    const table = document.createElement("table");
    const thead = document.createElement("thead");
    const tbody = document.createElement("tbody");

    // Build headings
    const headerRow = document.createElement("tr");
    Object.keys(groups[group][0]).forEach(key => {
      if (key !== "Indicative Selection") {
        const th = document.createElement("th");
        th.textContent = key;
        headerRow.appendChild(th);
      }
    });
    thead.appendChild(headerRow);

    // Build rows
    groups[group].forEach(row => {
      const tr = document.createElement("tr");
      Object.keys(row).forEach(key => {
        if (key !== "Indicative Selection") {
          const td = document.createElement("td");
          td.textContent = row[key];
          tr.appendChild(td);
        }
      });
      tbody.appendChild(tr);
    });

    table.appendChild(thead);
    table.appendChild(tbody);
    content.appendChild(table);

    wrapper.appendChild(header);
    wrapper.appendChild(content);
    container.appendChild(wrapper);
  });
}

loadData();
</script>
</body>
</html>
