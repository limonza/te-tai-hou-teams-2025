<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Te Tai Hou Teams – 2025</title>

<style>
body {
  font-family: "Segoe UI", Roboto, sans-serif;
  background-color: #f9fafb;
  margin: 0;
  padding: 20px;
  color: #333;
  display: flex;
  justify-content: center;
}
#page-wrapper {
  width: 100%;
  max-width: 75%;
  min-width: 320px;
}
header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
}
header img {
  height: 60px;
  border-radius: 50%;
}
header h1 {
  font-size: 1.8em;
  margin: 0;
  color: #1a365d;
}
.controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}
.controls input,
.controls select,
.controls button {
  padding: 6px 10px;
  border: 1px solid #cbd5e0;
  border-radius: 6px;
  font-size: 0.95em;
}
.controls input:focus,
.controls select:focus {
  outline: none;
  border-color: #2b6cb0;
  box-shadow: 0 0 4px rgba(43,108,176,0.3);
}
.controls button {
  background-color: #2b6cb0;
  color: white;
  cursor: pointer;
}
.controls button:hover {
  background-color: #1e4e8c;
}
section {
  margin-bottom: 1rem;
  border-radius: 0.75rem;
  background: #fff;
  box-shadow: 0 1px 4px rgba(0,0,0,0.1);
  overflow: hidden;
}
.group-header {
  font-weight: 600;
  font-size: 1.1rem;
  padding: 0.6rem 1rem;
  background: linear-gradient(to right, #ef4444, #f97316);
  color: #fff;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
}
.group-content {
  padding: 0;
  overflow-x: auto;
  transition: all 0.3s ease;
}
.group-content.hidden {
  display: none;
}
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
  table-layout: fixed;
}
thead th {
  background: #f3f4f6;
  position: sticky;
  top: 0;
  z-index: 2;
  padding: 0.5rem;
  text-align: left;
}
tbody td {
  border-top: 1px solid #e5e7eb;
  padding: 0.4rem 0.5rem;
  word-wrap: break-word;
}
tbody tr:hover {
  background: #f9fafb;
}
td:not(:last-child),
th:not(:last-child) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
td:last-child,
th:last-child {
  white-space: normal;
}
td:nth-child(2),
th:nth-child(2) {
  width: 30%;
}
@media (max-width: 768px) {
  #page-wrapper {
    max-width: 100%;
  }
  table, thead, tbody, th, td, tr {
    display: block;
  }
  thead {
    display: none;
  }
  tr {
    margin-bottom: 12px;
    border-bottom: 1px solid #ddd;
  }
  td {
    display: flex;
    justify-content: space-between;
    padding: 8px;
    white-space: normal;
  }
  td::before {
    content: attr(data-label);
    font-weight: 600;
    color: #2b6cb0;
  }
}
</style>
</head>

<body>
<div id="page-wrapper">
  <header>
    <a href="https://www.poriruaheatbasketball.org" target="_blank">
      <img src="images/logo.png" alt="Porirua Heat Logo">
    </a>
    <h1>TE TAI HOU TEAMS – 2025 TERM 4</h1>
  </header>

  <div class="controls">
    <input id="search" type="text" placeholder="Search...">
    <select id="selectionFilter">
      <option value="">All Teams</option>
    </select>
    <select id="clearedFilter">
      <option value="">All Cleared</option>
      <option value="Cleared">Cleared</option>
      <option value="Not Cleared">Not Cleared</option>
      <option value="(Blank)">(Blank)</option>
    </select>
    <select id="gdFilter">
      <option value="">All GD Regist.</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="(Blank)">(Blank)</option>
    </select>
    <button id="export">Export CSV</button>
    <button id="toggleGroups">Collapse All</button>
  </div>

  <div style="margin-top: 6px;">
    <a href="https://limonza.github.io/te-tai-hou-teams-2025/Training.html" style="font-size: 1em; color: #2b6cb0; text-decoration: underline;">
      Confirmed Club Registrations
    </a>
  </div>

  <div id="table-container"></div>
</div>

<script>
const data = [
  { fullName: "John Doe", email: "john@example.com", contact: "021111111", selection: "U15 Boys", paid: "Yes", cleared: "Cleared", gdRegist: "" },
  { fullName: "Jane Smith", email: "jane@example.com", contact: "022222222", selection: "U15 Boys", paid: "No", cleared: "", gdRegist: "Yes" },
  { fullName: "Alice Brown", email: "alice@example.com", contact: "023333333", selection: "U17 Girls", paid: "Yes", cleared: "Not Cleared", gdRegist: "No" },
  { fullName: "Ben White", email: "ben@example.com", contact: "024444444", selection: "U17 Girls", paid: "No", cleared: "", gdRegist: "" }
];

const tableContainer = document.getElementById("table-container");
const searchInput = document.getElementById("search");
const selectionFilter = document.getElementById("selectionFilter");
const clearedFilter = document.getElementById("clearedFilter");
const gdFilter = document.getElementById("gdFilter");
const toggleGroupsBtn = document.getElementById("toggleGroups");

let groupsCollapsed = false;

function renderTable() {
  const searchValue = searchInput.value.toLowerCase();
  const selectionValue = selectionFilter.value;
  const clearedValue = clearedFilter.value;
  const gdValue = gdFilter.value;

  const filtered = data.filter(d => {
    const matchSearch =
      d.fullName.toLowerCase().includes(searchValue) ||
      d.email.toLowerCase().includes(searchValue) ||
      d.contact.toLowerCase().includes(searchValue);

    const matchSelection = selectionValue === "" || d.selection === selectionValue;

    const matchCleared =
      clearedValue === "" ||
      (clearedValue === "(Blank)" && (!d.cleared || d.cleared.trim() === "")) ||
      d.cleared === clearedValue;

    const matchGD =
      gdValue === "" ||
      (gdValue === "(Blank)" && (!d.gdRegist || d.gdRegist.trim() === "")) ||
      d.gdRegist === gdValue;

    return matchSearch && matchSelection && matchCleared && matchGD;
  });

  const grouped = {};
  filtered.forEach(d => {
    if (!grouped[d.selection]) grouped[d.selection] = [];
    grouped[d.selection].push(d);
  });

  let html = "";
  Object.keys(grouped).forEach(group => {
    html += `<section>
      <div class="group-header">${group} <span>${grouped[group].length}</span></div>
      <div class="group-content ${groupsCollapsed ? 'hidden' : ''}">
        <table>
          <thead><tr>
            <th>Full Name</th>
            <th>Email</th>
            <th>Contact Number</th>
            <th>Indicative Selection</th>
            <th>Paid</th>
            <th>Cleared</th>
            <th>GD Regist.</th>
          </tr></thead>
          <tbody>
          ${grouped[group].map(d => `
            <tr>
              <td data-label="Full Name">${d.fullName}</td>
              <td data-label="Email">${d.email}</td>
              <td data-label="Contact Number">${d.contact}</td>
              <td data-label="Indicative Selection">${d.selection}</td>
              <td data-label="Paid">${d.paid}</td>
              <td data-label="Cleared">${d.cleared || ""}</td>
              <td data-label="GD Regist.">${d.gdRegist || ""}</td>
            </tr>`).join("")}
          </tbody>
        </table>
      </div>
    </section>`;
  });

  tableContainer.innerHTML = html;

  document.querySelectorAll(".group-header").forEach(header => {
    header.addEventListener("click", () => {
      const content = header.nextElementSibling;
      content.classList.toggle("hidden");
    });
  });
}

function populateFilters() {
  const selections = [...new Set(data.map(d => d.selection))].sort();
  selections.forEach(sel => {
    const opt = document.createElement("option");
    opt.value = sel;
    opt.textContent = sel;
    selectionFilter.appendChild(opt);
  });
}

searchInput.addEventListener("input", renderTable);
selectionFilter.addEventListener("change", renderTable);
clearedFilter.addEventListener("change", renderTable);
gdFilter.addEventListener("change", renderTable);
toggleGroupsBtn.addEventListener("click", () => {
  groupsCollapsed = !groupsCollapsed;
  renderTable();
});

document.getElementById("export").addEventListener("click", () => {
  const rows = [["Full Name","Email","Contact","Indicative Selection","Paid","Cleared","GD Regist."]];
  const currentRows = tableContainer.querySelectorAll("tbody tr");
  currentRows.forEach(tr => {
    const cells = Array.from(tr.children).map(td => td.innerText);
    rows.push(cells);
  });
  const csv = rows.map(r => r.map(x => `"${x}"`).join(",")).join("\n");
  const blob = new Blob([csv], {type: "text/csv"});
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "TeTaiHouTeams2025.csv";
  link.click();
});

populateFilters();
renderTable();
</script>
</body>
</html>
