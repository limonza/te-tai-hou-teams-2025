<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SUNDAY TRAINING SESSION TERM 1 - 2026</title>

<style>
body {
  font-family: "Segoe UI", Roboto, sans-serif;
  background-color: #f9fafb;
  margin: 0;
  padding: 20px;
  color: #333;
  display: flex;
  justify-content: center;
}
#page-wrapper {
  width: 100%;
  max-width: 900px;
}
header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
}
header img {
  height: 60px;
  width: auto;
  border-radius: 50%;
}
header h1 {
  font-size: 1.8em;
  margin: 0;
  color: #1a365d;
}
.controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}
.controls input,
.controls select,
.controls button {
  padding: 6px 10px;
  border: 1px solid #cbd5e0;
  border-radius: 6px;
  font-size: 0.95em;
}
.controls button {
  background-color: #2b6cb0;
  color: white;
  cursor: pointer;
}
section {
  margin-bottom: 1rem;
  border-radius: 0.75rem;
  background: #fff;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
}
.group-header {
  font-weight: 600;
  font-size: 1.1rem;
  padding: 0.6rem 1rem;
  background: linear-gradient(to right, #ef4444, #f97316);
  color: #fff;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.group-content {
  padding: 0;
  overflow-x: auto;
}
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
  table-layout: fixed;
}
thead th {
  background: #f3f4f6;
  position: sticky;
  top: 0;
  z-index: 2;
  padding: 0.5rem;
  text-align: left;
}
tbody td {
  border-top: 1px solid #e5e7eb;
  padding: 0.4rem 0.5rem;
  word-wrap: break-word;
}
</style>
</head>

<body>
<div id="page-wrapper">
  <header>
    <a href="https://www.poriruaheatbasketball.org" target="_blank">
      <img src="images/logo.png" alt="Porirua Heat Logo" />
    </a>
    <h1>SUNDAY TRAINING SESSION TERM 1 - 2026</h1>
  </header>

  <div class="controls">
    <input id="search" type="text" placeholder="Search..." />
    <select id="selectionFilter"><option value="">All Groups</option></select>
    <button id="pdfBtn">Generate PDF</button>
  </div>

  <div id="table-container"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>

<script>
const search = document.getElementById("search");
const selectionFilter = document.getElementById("selectionFilter");
const container = document.getElementById("table-container");

let headers = [];
let allRows = [];

const groupIndex = 1;
const nameIndex = 0;

fetch("Sunday.csv")
  .then(res => res.text())
  .then(text => {
    const lines = text.trim().split("\n").map(l => l.split(","));
    headers = lines[0].map(h => h.trim());
    allRows = lines.slice(1).map(r => r.map(c => c.trim()));
    populateDropdown();
    renderGroups(allRows);
  });

function populateDropdown() {
  const unique = [...new Set(allRows.map(r => r[groupIndex]))];
  unique.forEach(v => {
    const opt = document.createElement("option");
    opt.value = v;
    opt.textContent = v;
    selectionFilter.appendChild(opt);
  });
}

function renderGroups(rows) {
  container.innerHTML = "";

  const groups = rows.reduce((acc, row) => {
    const key = row[groupIndex];
    if (!acc[key]) acc[key] = [];
    acc[key].push(row);
    return acc;
  }, {});

  const filterVal = selectionFilter.value;
  const keys = filterVal ? [filterVal] : Object.keys(groups).sort();

  keys.forEach(groupName => {
    const groupRows = groups[groupName];
    if (!groupRows) return;

    groupRows.sort((a, b) => a[nameIndex].localeCompare(b[nameIndex]));

    const section = document.createElement("section");

    const header = document.createElement("div");
    header.className = "group-header";
    header.innerHTML = `<span>${groupName}</span><span>${groupRows.length} Records</span>`;
    section.appendChild(header);

    const wrapper = document.createElement("div");
    wrapper.className = "group-content";

    const table = document.createElement("table");

    const thead = document.createElement("thead");
    const tr = document.createElement("tr");

    const numTh = document.createElement("th");
    numTh.textContent = "#";
    tr.appendChild(numTh);

    headers.forEach((h, i) => {
      if (i !== groupIndex) {
        const th = document.createElement("th");
        th.textContent = h;
        tr.appendChild(th);
      }
    });

    thead.appendChild(tr);
    table.appendChild(thead);

    const tbody = document.createElement("tbody");

    groupRows.forEach((r, idx) => {
      const rowTr = document.createElement("tr");

      const numTd = document.createElement("td");
      numTd.textContent = idx + 1;
      rowTr.appendChild(numTd);

      r.forEach((c, i) => {
        if (i !== groupIndex) {
          const td = document.createElement("td");

          // === MAKE FIRST NAME BOLD ===
          if (i === nameIndex) {
            const parts = c.split(" ");
            const firstName = parts.shift();
            const rest = parts.join(" ");
            td.innerHTML = `<strong>${firstName}</strong> ${rest}`;
          } else {
            td.textContent = c;
          }

          rowTr.appendChild(td);
        }
      });

      tbody.appendChild(rowTr);
    });

    table.appendChild(tbody);
    wrapper.appendChild(table);
    section.appendChild(wrapper);
    container.appendChild(section);
  });
}

function applyFilters() {
  const q = search.value.toLowerCase();
  const sel = selectionFilter.value;

  const filtered = allRows.filter(r => {
    const matchesSearch = r.some(c => c.toLowerCase().includes(q));
    const matchesSel = !sel || r[groupIndex] === sel;
    return matchesSearch && matchesSel;
  });

  renderGroups(filtered);
}

search.addEventListener("input", applyFilters);
selectionFilter.addEventListener("change", applyFilters);

// PDF code remains unchanged
</script>
</body>
</html>
